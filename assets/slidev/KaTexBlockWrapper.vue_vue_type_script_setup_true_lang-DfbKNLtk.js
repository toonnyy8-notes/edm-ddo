import{d as L,t as _,Q as A,O as k,z as y,D as E,o as b,b as I,f as x}from"../modules/vue-uNfDDzE2.js";import{p as K}from"./chunk-3LX2JHFR-BLv_DZIW.js";import{a9 as N,C as q,aa as B,ab as D}from"../index-vlWtBPU0.js";import{u as M}from"./context-tF2mfBRA.js";const O=L({__name:"KaTexBlockWrapper",props:{ranges:{type:Array,default:()=>[]},finally:{type:[String,Number],default:"last"},startLine:{type:Number,default:1},at:{type:[String,Number],default:"+1"}},setup(S){const e=S,{$clicksContext:a}=M(),o=_(),f=N();return A(()=>{a.unregister(f)}),k(()=>{var p;if(!a||!((p=e.ranges)!=null&&p.length))return;const r=a.calculateSince(e.at,e.ranges.length-1);a.register(f,r);const i=y(()=>r?Math.max(0,a.current-r.start+1):q),g=y(()=>e.finally==="last"?e.ranges.at(-1):e.finally.toString());E(()=>{if(!o.value)return;let c=e.ranges[i.value]??g.value;const m=c==="hide";o.value.classList.toggle(B,m),m&&(c=e.ranges[i.value+1]??g.value);const h=o.value.querySelectorAll(".mtable > [class*=col-align]");if(!h)return;const v=Array.from(h).map(n=>Array.from(n.querySelectorAll(":scope > .vlist-t > .vlist-r > .vlist > span > .mord"))),s=[];for(const n of v)n.forEach((l,t)=>{l&&(Array.isArray(s[t])?s[t].push(l):s[t]=[l])});const d=e.startLine,C=K(s.length+d-1,c);s.forEach((n,l)=>{const t=C.includes(l+d);n.forEach(u=>{u.classList.toggle(D,!0),u.classList.toggle("highlighted",t),u.classList.toggle("dishonored",!t)})})})}),(r,i)=>(b(),I("div",{ref_key:"el",ref:o,class:"slidev-katex-wrapper"},[x(r.$slots,"default")],512))}});export{O as _};
